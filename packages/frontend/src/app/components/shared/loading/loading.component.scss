@use '../../../styles/theme' as *;

.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 2rem;
  min-height: 120px;
  text-align: center;

  &.small {
    padding: 1rem;
    min-height: 80px;
    gap: 0.5rem;
  }

  &.large {
    padding: 3rem;
    min-height: 200px;
    gap: 1.5rem;
  }

  &.has-error {
    .loading-spinner {
      .spinner-ring {
        border-color: var(--color-secondary, #a43f49);
        border-top-color: transparent;
      }
    }

    .loading-text {
      color: var(--color-secondary, #a43f49);
    }
  }

  &.retrying {
    .loading-spinner {
      .spinner-ring {
        animation-duration: 0.5s;
      }
    }
  }

  // Ensure component works even if theme loads after component
  &.ready {
    opacity: 1;
    transform: translateY(0);
  }

  &:not(.ready) {
    opacity: 0.8;
    transform: translateY(2px);
    transition: opacity 0.2s ease, transform 0.2s ease;
  }
}

.loading-spinner {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
  border-radius: 50%;
  box-shadow: 0 6px 18px rgba(0,0,0,0.18), inset 0 2px 6px rgba(255,255,255,0.02);
  .spinner-ring {
  position: absolute;
  border: 3px solid var(--color-border-primary, rgba(250, 250, 250, 0.08));
  border-top: 3px solid var(--color-primary, #4058d3);
  border-radius: 50%;
  animation: spin 900ms cubic-bezier(0.4,0,0.2,1) infinite;

    &:nth-child(1) { width: 100%; height: 100%; }
    &:nth-child(2) { width: 76%; height: 76%; animation-delay: -0.18s; border-top-color: var(--color-primary-light, #5a6dd8); }
    &:nth-child(3) { width: 52%; height: 52%; animation-delay: -0.36s; border-top-color: var(--color-primary-dark, #2d4bb5); }
  }
}

.loading-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
}

.loading-text {
  color: var(--text-primary, #ffffff);
  font-weight: 400;
  margin: 0;
  transition: color var(--animation-duration-fast, 0.15s) var(--animation-easing, cubic-bezier(0.4, 0, 0.2, 1));
}

.retry-button {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: var(--color-bg-glass, rgba(255, 255, 255, 0.1));
  border: 1px solid var(--color-border-primary, rgba(250, 250, 250, 0.1));
  border-radius: 6px;
  color: var(--text-primary, #ffffff);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--animation-duration-fast, 0.15s) var(--animation-easing, cubic-bezier(0.4, 0, 0.2, 1));
  backdrop-filter: blur(10px);

  &:hover:not(:disabled), &:focus-visible:not(:disabled) {
    background: var(--color-bg-glass-hover, rgba(255, 255, 255, 0.15));
    border-color: var(--color-border-secondary, rgba(250, 250, 250, 0.3));
    transform: translateY(-1px);
    box-shadow: 0 4px 12px var(--shadow-medium, rgba(0, 0, 0, 0.2));
  }

  &:focus-visible {
    outline: 3px solid rgba(64,88,211,0.18);
    outline-offset: 3px;
  }

  &:active:not(:disabled) {
    transform: translateY(0);
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
  }

  .retry-icon {
    font-size: 1rem;
    transition: transform var(--animation-duration-normal, 0.8s) var(--animation-easing, cubic-bezier(0.4, 0, 0.2, 1));

    &.spinning {
      animation: spin 1s linear infinite;
    }
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .loading-container {
    padding: 1.5rem 1rem;

    &.small {
      padding: 0.75rem 0.5rem;
    }

    &.large {
      padding: 2rem 1rem;
    }
  }

  .retry-button {
    padding: 0.625rem 1.25rem;
    font-size: 0.8125rem;
  }
}

.easter-top {
  display: inline-block;
  position: relative;
  font-size: 0.78rem;
  color: var(--loading-top-color, var(--color-text-secondary, #cfcfcf));
  opacity: 0.95;
  margin-bottom: 0.25rem;
  font-weight: 600;
  /* Allow adjustable letter spacing for improved legibility when stroked */
  --loading-top-letter-spacing: 0.06em;
  letter-spacing: var(--loading-top-letter-spacing);
  text-transform: none;
  padding: 0 0.25rem;
  border-radius: 4px;
  transition: transform 280ms var(--animation-easing, cubic-bezier(0.4,0,0.2,1)), opacity 200ms ease;
  will-change: transform, opacity;
  /* subtle floating animation to keep it engaging during long loads */
  animation: loading-top-float 3.6s ease-in-out infinite;
  /* Apply a thin stroke to the text itself (preferred). Use slightly less than 1px
    visually to reduce harshness when combined with letter spacing. */
  -webkit-text-stroke: 0.9px var(--loading-top-glow, var(--color-primary, #4058d3));
  -webkit-text-fill-color: var(--loading-top-color, var(--color-text-secondary, #cfcfcf));
  /* Fallback for browsers that don't support text-stroke: approximate a solid
     1px outline using multiple text-shadows (covers cardinal and diagonal offsets). */
  text-shadow:
    -1px 0 var(--loading-top-glow, var(--color-primary, #4058d3)),
    1px 0 var(--loading-top-glow, var(--color-primary, #4058d3)),
    0 -1px var(--loading-top-glow, var(--color-primary, #4058d3)),
    0 1px var(--loading-top-glow, var(--color-primary, #4058d3));
}

@keyframes loading-top-float {
  0% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
  100% { transform: translateY(0); }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .easter-top { animation: none !important; transform: none !important; }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .spinner-ring { animation: none !important; }
  .retry-icon.spinning { animation: none !important; }
}